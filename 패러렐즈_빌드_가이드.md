# 패러렐즈 Windows 빌드 가이드

패러렐즈에서 Windows 실행 파일을 빌드하기 위한 설치 가이드입니다.

## 1. Windows OS 설치

패러렐즈에 Windows 10 또는 Windows 11을 설치합니다.
- Windows 10 (64-bit) 권장
- Windows 11도 가능

## 2. 필수 프로그램 설치

### 2.1 Python 3.12 이상

**다운로드 및 설치:**
1. [Python 공식 사이트](https://www.python.org/downloads/)에서 Python 3.12 이상 다운로드
2. 설치 시 **"Add Python to PATH"** 옵션 반드시 체크
3. 설치 완료 후 확인:
   ```cmd
   python --version
   ```

**또는 Microsoft Store에서 설치:**
- Microsoft Store에서 "Python 3.12" 검색 후 설치

### 2.2 Git (선택사항, 권장)

프로젝트 파일을 복사하거나 클론하기 위해 필요합니다.

**다운로드:**
- [Git for Windows](https://git-scm.com/download/win)
- 설치 시 기본 옵션으로 진행

### 2.3 Visual C++ Redistributable (필수)

PyInstaller가 생성한 실행 파일 실행에 필요합니다.

**다운로드:**
- [Microsoft Visual C++ Redistributable](https://learn.microsoft.com/en-us/cpp/windows/latest-supported-vc-redist)
- 최신 버전 다운로드 및 설치 (x64)

## 3. Python 패키지 설치

### 3.1 pip 업그레이드

```cmd
python -m pip install --upgrade pip
```

### 3.2 프로젝트 의존성 설치

프로젝트 폴더로 이동 후:

```cmd
# 방법 1: pip로 직접 설치
pip install msoffcrypto-tool>=5.4.2
pip install openpyxl>=3.1.5
pip install pandas>=2.3.3
pip install pyside6>=6.9.3

# 방법 2: pyproject.toml이 있는 경우
pip install -e .

# 방법 3: requirements.txt가 있다면
pip install -r requirements.txt
```

### 3.3 PyInstaller 설치

```cmd
pip install pyinstaller
```

## 4. 프로젝트 파일 준비

### 4.1 프로젝트 파일 복사 방법

**옵션 1: 공유 폴더 사용 (권장)**
- 패러렐즈 설정에서 macOS 폴더를 Windows와 공유 설정
- Windows에서 공유 폴더 접근하여 프로젝트 복사

**옵션 2: Git 사용**
- Windows에 Git 설치 후 클론:
  ```cmd
  git clone <저장소_URL>
  ```

**옵션 3: USB/네트워크 전송**
- 프로젝트 폴더를 압축하여 전송

### 4.2 필수 파일 확인

프로젝트 폴더에 다음 파일들이 있는지 확인:
```
rider-receipt-merger/
├── main.py
├── config/
│   ├── settings.json
│   └── settings.py
├── core/
│   ├── data_processor.py
│   ├── file_manager.py
│   └── mapping_manager.py
├── ui/
│   ├── main_window.py
│   ├── mapping_dialog.py
│   └── ui_components.py
├── utils/
│   ├── logger.py
│   └── validators.py
├── mapping_config.json
└── pyproject.toml
```

## 5. 빌드 실행

### 5.1 명령 프롬프트 또는 PowerShell 열기

프로젝트 폴더에서 우클릭 → "터미널에서 열기" 또는 "PowerShell에서 열기"

### 5.2 빌드 스크립트 실행

**방법 1: build.bat 사용 (권장)**

프로젝트 루트에 `build.bat` 파일이 있다면:
```cmd
build.bat
```

**방법 2: 직접 PyInstaller 실행**

```cmd
pyinstaller --name="RiderReceiptMerger" --windowed --onefile --icon=NONE --add-data="config;config" --add-data="mapping_config.json;." --hidden-import=openpyxl --hidden-import=msoffcrypto --hidden-import=PySide6 --collect-all=openpyxl --collect-all=msoffcrypto main.py
```

### 5.3 빌드 결과 확인

빌드 완료 후:
- 실행 파일 위치: `dist\RiderReceiptMerger.exe`
- 파일 크기: 약 50-100MB (정상)

## 6. 테스트

### 6.1 Windows에서 테스트

```cmd
dist\RiderReceiptMerger.exe
```

### 6.2 테스트 항목

- [ ] 프로그램이 정상적으로 실행되는가?
- [ ] 파일 선택 기능이 작동하는가?
- [ ] 매핑 설정이 로드되는가?
- [ ] 병합 기능이 정상 작동하는가?
- [ ] 암호화된 Excel 파일을 읽을 수 있는가?

## 7. 문제 해결

### 7.1 "Python을 찾을 수 없습니다" 오류

- Python 설치 시 "Add to PATH" 옵션을 체크했는지 확인
- 환경 변수 PATH에 Python 경로가 추가되었는지 확인
- 명령 프롬프트를 재시작

### 7.2 "ModuleNotFoundError" 오류

필요한 패키지가 설치되지 않았습니다:
```cmd
pip install <패키지명>
```

### 7.3 "Permission denied" 오류

관리자 권한으로 명령 프롬프트 실행:
- 시작 메뉴 → "cmd" 검색 → 우클릭 → "관리자 권한으로 실행"

### 7.4 PyInstaller 실행 파일이 작동하지 않는 경우

1. Visual C++ Redistributable 설치 확인
2. Windows Defender나 백신 프로그램이 차단하는지 확인
3. 빌드 로그 확인: `build\RiderReceiptMerger\warn-RiderReceiptMerger.txt`

## 8. 설치 체크리스트

빌드 전 확인사항:

- [ ] Windows 10/11 설치 완료
- [ ] Python 3.12 이상 설치 및 PATH 설정 완료
- [ ] Visual C++ Redistributable 설치 완료
- [ ] Git 설치 완료 (선택사항)
- [ ] 프로젝트 파일 복사 완료
- [ ] 모든 Python 패키지 설치 완료
- [ ] PyInstaller 설치 완료

## 9. 빠른 설치 스크립트

Windows에서 다음 스크립트를 실행하면 필요한 패키지를 자동으로 설치합니다:

**install_dependencies.bat 파일 생성:**

```batch
@echo off
echo Python 패키지 설치 시작...

python -m pip install --upgrade pip
pip install msoffcrypto-tool>=5.4.2
pip install openpyxl>=3.1.5
pip install pandas>=2.3.3
pip install pyside6>=6.9.3
pip install pyinstaller

echo.
echo 설치 완료!
pause
```

## 10. 참고사항

- 패러렐즈에서 Windows를 실행할 때는 충분한 메모리(최소 4GB, 권장 8GB) 할당
- 빌드 과정에서 디스크 공간이 필요합니다 (약 500MB-1GB)
- 첫 빌드는 시간이 오래 걸릴 수 있습니다 (5-10분)
- Windows Defender가 실행 파일을 차단할 수 있으므로 예외 처리 필요

